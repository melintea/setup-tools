<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE scenario SYSTEM "sipp.dtd">

<!--                                                                    -->
<!--                 Sipp default 'uac' scenario.                       -->
<!--                                                                    -->
<!-- 
      Contact: <sip:tsvm_user@dev2000.com;opaque=user:epid:tpEaNMMGBVCsFTOJGDfp3gAA;gruu>
-->
<scenario name="Basic Lync UAC">
  <!-- In client mode (sipp placing calls), the Call-ID MUST be         -->
  <!-- generated by sipp. To do so, use [call_id] keyword.              -->
  <send retrans="500">
    <![CDATA[

      INVITE sip:tsvm_user@aurelianclay.dev2000.com SIP/2.0
      Via: SIP/2.0/[transport] [local_ip]:[local_port];ms-received-port=[local_port];ms-received-cid=20B0200;branched=FALSE
      From: "tsvm_user"<sip:tsvm_user@dev2000.com>;tag=[call_number];epid=cdce0283be
      To: <sip:tsvm_user@aurelianclay.dev2000.com>
      Call-ID: [call_id]
      CSeq: 1 INVITE
      Contact: <sip:tsvm_user@[local_ip]:[local_port];opaque=user:epid:tpEaNMMGBVCsFTOJGDfp3gAA;gruu>
      User-Agent: UCCAPI/4.0.7577.0 OC/4.0.7577.0 (Microsoft Lync 2010)
      Supported: ms-dialog-route-set-update
      Content-Disposition: signal;handling=required
      Supported: timer
      Supported: histinfo
      Supported: ms-safe-transfer
      Supported: ms-sender
      Supported: ms-early-media
      ms-application-via: backend_token;ms-server=[local_ip];ms-pool=Lync2010Pool.dev2000.com;ms-application=51FB453D-5B9F-45df-83B4-ADD1F7E604A8
      ms-keep-alive: UAC;hop-hop=yes
      Allow: INVITE, BYE, ACK, CANCEL, INFO, UPDATE, REFER, NOTIFY, BENOTIFY, OPTIONS
      ms-subnet: [local_ip]
      Content-Type: application/csta+xml
      Content-Length: [len]
      ms-routing-phase:from-uri-routing-done
      ms-user-data: ms-publiccloud=TRUE;ms-federation=TRUE

      <?xml version="1.0"?>
      <RequestSystemStatus xmlns="http://www.ecma-international.org/standards/ecma-323/csta/ed3"><extensions><privateData><private><lcs:line xmlns:lcs="http://schemas.microsoft.com/Lcs/2005/04/RCCExtension">tel:+8891</lcs:line></private></privateData></extensions></RequestSystemStatus>

    ]]>
  </send>

  <recv response="100"
        optional="true">
  </recv>

  <recv response="180" 
        optional="true">
  </recv>

  <!-- By adding rrs="true" (Record Route Sets), the route sets         -->
  <!-- are saved and used for following messages sent. Useful to test   -->
  <!-- against stateful SIP proxies/B2BUAs.                             -->
  <recv response="200" 
        rtd="true">
  </recv>

  <!-- Packet lost can be simulated in any send/recv message by         -->
  <!-- by adding the 'lost = "10"'. Value can be [1-100] percent.       -->
  <send>
    <![CDATA[

      ACK sip:[remote_ip]:[remote_port];transport=[transport] SIP/2.0
      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch];branched=FALSE
      From: <sip:tsvm_user@dev2000.com>;tag=[call_number];epid=cdce0283be
      To: <sip:tsvm_user@aurelianclay.dev2000.com>[peer_tag_param]
      Call-ID: [call_id]
      CSeq: 1 ACK
      Max-Forwards: 70
      User-Agent: UCCAPI/4.0.7577.0 OC/4.0.7577.0 (Microsoft Lync 2010)
      Content-Length: 0
      ms-routing-phase:from-uri-routing-done

    ]]>
  </send>

  <pause/>

  <send retrans="500">
    <![CDATA[

      NEGOTIATE sip:127.0.0.1:[remote_port] SIP/2.0
      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch].info1;branched=FALSE
      Max-Forwards: 0
      From: <sip:tsvm_user@dev2000.com>;tag=[call_number];epid=cdce0283be
      To: <sip:tsvm_user@aurelianclay.dev2000.com>[peer_tag_param]
      Call-ID: [call_id]
      CSeq: 1 NEGOTIATE
      Require: ms-compression
      ms-negotiate-data: LZ77-64K
      Supported: NewNegotiate,OCSNative,ECC
      Server: RTC/4.0
      Content-Length: 0

    ]]>
  </send>

  <recv response="501" 
        rtd="true">
  </recv>


  <!-- This delay can be customized by the -d command-line option       -->
  <!-- or by adding a 'milliseconds = "value"' option here.             -->
  <pause/>

  <!-- The 'crlf' option inserts a blank line in the statistics report. -->
  <send retrans="500">
    <![CDATA[

      BYE sip:[remote_ip]:[remote_port] SIP/2.0
      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch];branched=FALSE
      From: <sip:tsvm_user@dev2000.com>;tag=[call_number];epid=cdce0283be
      To: <sip:tsvm_user@aurelianclay.dev2000.com>[peer_tag_param]
      User-Agent: UCCAPI/4.0.7577.0 OC/4.0.7577.0 (Microsoft Lync 2010)
      Call-ID: [call_id]
      CSeq: 2 BYE
      Max-Forwards: 70
      Content-Length: 0

    ]]>
  </send>

  <recv response="200" crlf="true">
  </recv>

  <!-- definition of the response time repartition table (unit is ms)   -->
  <ResponseTimeRepartition value="10, 20, 30, 40, 50, 100, 150, 200"/>

  <!-- definition of the call length repartition table (unit is ms)     -->
  <CallLengthRepartition value="10, 50, 100, 500, 1000, 5000, 10000"/>

</scenario>

